<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMSSS Assessment Workflow - Pure JS</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Base styles */
        body {
            font-family: ui-sans-serif, system-ui, sans-serif;
            background-color: #f8f9fa; /* Light background */
            min-height: 100vh;
        }
        .custom-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scroll::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
        }
        .custom-scroll::-webkit-scrollbar-track {
            background-color: #f1f5f9;
        }
    </style>
</head>
<body>

    <div id="root" class="p-4 md:p-8"></div>

    <script>
        const { useState, useEffect, useMemo, useCallback } = React;

        // Custom Hook to load Lucide Icons globally
        const useLucideIcons = () => {
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, []);
        };

        // Helper function for React.createElement
        const e = React.createElement;

        // --- STEP 1 COMPONENT ---
        const Step1 = ({ onNext, assessmentType, setAssessmentType }) => {
            useLucideIcons();
            
            const handleSelection = (type) => {
                setAssessmentType(type);
            };

            const typeOptions = [
                { id: 'baseline', name: 'Baseline Assessment', description: 'Initial assessment to establish current state and needs.', icon: 'CheckCircle' },
                { id: 'followup', name: 'Follow-up Assessment', description: 'Re-assessment after interventions or changes.', icon: 'Repeat2' },
                { id: 'ad_hoc', name: 'Ad-Hoc Assessment', description: 'Targeted assessment for a specific issue or incident.', icon: 'AlertTriangle' },
            ];

            return e('div', { className: "space-y-6" },
                e('h2', { className: "text-2xl font-semibold text-gray-800 border-b pb-3 mb-4" }, "Step 1: Select Assessment Type"),
                
                e('div', { className: "grid md:grid-cols-3 gap-6" },
                    typeOptions.map((option) => (
                        e('div', {
                            key: option.id,
                            onClick: () => handleSelection(option.id),
                            className: `
                                p-6 border-2 rounded-xl shadow-lg cursor-pointer transition-all duration-200
                                ${assessmentType === option.id 
                                    ? 'border-indigo-600 bg-indigo-50 shadow-indigo-200' 
                                    : 'border-gray-200 bg-white hover:border-indigo-400 hover:shadow-md'
                                }
                            `
                        },
                            e('div', { className: "flex items-center space-x-4" },
                                e('div', { 
                                    'data-lucide': option.icon, 
                                    className: `w-8 h-8 ${assessmentType === option.id ? 'text-indigo-600' : 'text-gray-500'}`
                                }),
                                e('h3', { className: "text-xl font-bold text-gray-700" }, option.name)
                            ),
                            e('p', { className: "mt-3 text-gray-500 text-sm" }, option.description)
                        )
                    ))
                ),

                e('div', { className: "flex justify-end pt-4" },
                    e('button', {
                        onClick: onNext,
                        disabled: !assessmentType,
                        className: `
                            px-6 py-2 text-white font-medium rounded-lg transition duration-150
                            ${assessmentType 
                                ? 'bg-indigo-600 hover:bg-indigo-700' 
                                : 'bg-gray-400 cursor-not-allowed'
                            }
                        `
                    }, "Continue to Step 2")
                )
            );
        };

        // --- STEP 2 COMPONENT ---
        const Step2 = ({ onNext, onPrevious, persistenceMechanism, setPersistenceMechanism }) => {
            useLucideIcons();

            const handleSelection = (mechanism) => {
                setPersistenceMechanism(mechanism);
            };

            const mechanismOptions = [
                { id: 'local_storage', name: 'Local Storage', description: 'Data is saved in the browser, allowing resume on the same device.', icon: 'HardDrive' },
                { id: 'server_db', name: 'Server Database', description: 'Data is stored remotely, enabling cross-device access and collaboration.', icon: 'Database' },
                { id: 'print_pdf', name: 'Print/PDF Only', description: 'No digital persistence; data is captured by printing or saving as PDF.', icon: 'Printer' },
            ];

            return e('div', { className: "space-y-6" },
                e('h2', { className: "text-2xl font-semibold text-gray-800 border-b pb-3 mb-4" }, "Step 2: Select Persistence Mechanism"),
                
                e('div', { className: "grid md:grid-cols-3 gap-6" },
                    mechanismOptions.map((option) => (
                        e('div', {
                            key: option.id,
                            onClick: () => handleSelection(option.id),
                            className: `
                                p-6 border-2 rounded-xl shadow-lg cursor-pointer transition-all duration-200
                                ${persistenceMechanism === option.id 
                                    ? 'border-indigo-600 bg-indigo-50 shadow-indigo-200' 
                                    : 'border-gray-200 bg-white hover:border-indigo-400 hover:shadow-md'
                                }
                            `
                        },
                            e('div', { className: "flex items-center space-x-4" },
                                e('div', { 
                                    'data-lucide': option.icon, 
                                    className: `w-8 h-8 ${persistenceMechanism === option.id ? 'text-indigo-600' : 'text-gray-500'}`
                                }),
                                e('h3', { className: "text-xl font-bold text-gray-700" }, option.name)
                            ),
                            e('p', { className: "mt-3 text-gray-500 text-sm" }, option.description)
                        )
                    ))
                ),

                e('div', { className: "flex justify-between pt-4" },
                    e('button', {
                        onClick: onPrevious,
                        className: "px-6 py-2 text-gray-600 bg-gray-200 hover:bg-gray-300 font-medium rounded-lg transition duration-150"
                    }, 
                        e('span', { 'data-lucide': "ArrowLeft", className: "inline-block w-4 h-4 mr-2" }),
                        "Back to Step 1"
                    ),
                    e('button', {
                        onClick: onNext,
                        disabled: !persistenceMechanism,
                        className: `
                            px-6 py-2 text-white font-medium rounded-lg transition duration-150
                            ${persistenceMechanism 
                                ? 'bg-indigo-600 hover:bg-indigo-700' 
                                : 'bg-gray-400 cursor-not-allowed'
                            }
                        `
                    }, 
                        "Complete Setup",
                        e('span', { 'data-lucide': "Check", className: "inline-block w-4 h-4 ml-2" })
                    )
                )
            );
        };

        // --- IMSSS CONTAINER COMPONENT ---
        const AssessorContainer = () => {
            // State for the application flow
            const [step, setStep] = useState(1);
            const [assessmentType, setAssessmentType] = useState(null);
            const [persistenceMechanism, setPersistenceMechanism] = useState(null);

            // Function to navigate between steps
            const nextStep = () => setStep(prev => prev + 1);
            const previousStep = () => setStep(prev => prev - 1);

            const renderStep = () => {
                switch (step) {
                    case 1:
                        return e(Step1, {
                            onNext: nextStep,
                            assessmentType: assessmentType,
                            setAssessmentType: setAssessmentType,
                        });
                    case 2:
                        return e(Step2, {
                            onNext: nextStep,
                            onPrevious: previousStep,
                            persistenceMechanism: persistenceMechanism,
                            setPersistenceMechanism: setPersistenceMechanism,
                        });
                    case 3:
                        return e('div', { className: "text-center p-12 bg-green-50 rounded-xl shadow-lg" },
                            e('span', { 'data-lucide': "Award", className: "w-16 h-16 text-green-600 mx-auto block mb-4" }),
                            e('h2', { className: "text-3xl font-bold text-green-800" }, "Setup Complete!"),
                            e('p', { className: "mt-2 text-lg text-green-700" }, "IMSSS Assessor is now configured with:"),
                            e('ul', { className: "mt-4 space-y-2 text-left inline-block" },
                                e('li', { className: "text-gray-700 font-medium" }, 
                                    "Assessment Type: ", 
                                    e('span', { className: "text-indigo-600 capitalize" }, assessmentType.replace('_', ' '))
                                ),
                                e('li', { className: "text-gray-700 font-medium" }, 
                                    "Persistence Method: ", 
                                    e('span', { className: "text-indigo-600 capitalize" }, persistenceMechanism.replace('_', ' '))
                                )
                            ),
                            e('button', {
                                onClick: () => setStep(1),
                                className: "mt-8 px-6 py-2 text-white bg-indigo-600 hover:bg-indigo-700 font-medium rounded-lg transition duration-150"
                            }, "Start Over")
                        );
                    default:
                        return null;
                }
            };

            return e('div', { className: "max-w-4xl mx-auto bg-white p-6 md:p-10 rounded-2xl shadow-2xl custom-scroll" },
                e('h1', { className: "text-3xl font-extrabold text-indigo-700 mb-6 border-b-4 border-indigo-200 pb-2" }, "IMSSS Assessor Setup Wizard"),
                
                // Progress Bar
                e('div', { className: "mb-8" },
                    e('div', { className: "flex justify-between text-sm font-medium text-gray-500 mb-2" },
                        e('span', null, `Step ${step} of 3`),
                        e('span', { className: "text-indigo-600" }, step === 3 ? 'Finished' : 'Setup in Progress')
                    ),
                    e('div', { className: "w-full bg-gray-200 rounded-full h-2.5" },
                        e('div', { 
                            className: "bg-indigo-600 h-2.5 rounded-full transition-all duration-500", 
                            style: { width: `${(step / 3) * 100}%` }
                        })
                    )
                ),

                renderStep()
            );
        };

        // --- MAIN APP COMPONENT ---
        const MainApp = () => {
            return e('div', { className: "h-full w-full" }, e(AssessorContainer));
        };
        
        // --- MANUAL MOUNT (No Babel needed) ---
        document.addEventListener('DOMContentLoaded', function() {
            const rootElement = document.getElementById('root');
            if (rootElement) {
                ReactDOM.createRoot(rootElement).render(e(MainApp));
                console.log("IMSSS App successfully rendered using pure JavaScript!");
            } else {
                console.error("Root element not found.");
            }
        });
    </script>
</body>
</html>
